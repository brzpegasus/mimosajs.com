<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Server Options and Setup - Mimosa</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="css/main.css"> -->
  <link rel="stylesheet" href="css/bootstrap.min.css" >
  <link rel="stylesheet" href="css/bootstrap-responsive.min.css" >
  <link rel="stylesheet" href="css/app.css">

  <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="img/apple-touch-icon-57-precomposed.png">
</head>
<body data-spy="scroll" data-target=".subnav" data-offset="50">

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <div class="nav-collapse collapse">
          <ul class="nav">
            <li class="">
              <a href="./index.html">Mimosa</a>
            </li>
            <li class="">
              <a href="./started.html">Get Started</a>
            </li>
            <li class="">
              <a href="./commands.html">Commands</a>
            </li>
            <li class="">
              <a href="./compilers.html">Compilers</a>
            </li>
            <li  class="">
              <a href="./modules.html">Extend: Modules</a>
            </li>
            <li class="active">
              <a href="./server.html">Serve</a>
            </li>
            <li class="">
              <a href="./utilities.html">Utilities</a>
            </li>
            <li class="">
              <a href="./optimization.html">Optimization</a>
            </li>
            <li class="">
              <a href="./configuration.html">Configuration</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container main">

  <header class="jumbotron subhead" id="overview">
    <h1>Server Resources</h1>
    <p class="lead">Mimosa jump starts and integrates your server development </p>
    <div class="subnav">
      <ul class="nav nav-pills">
        <li><a href="#overview" title="How Mimosa's server resources work">Overview</a></li>
        <li><a href="#new" title="What Mimosa delivers">Via 'mimosa new'</a></li>
        <li><a href="#mimosas" title="Mimosa's embedded server">Mimosa's Server</a></li>
        <li><a href="#yours" title="How Mimosa invokes your server">Your Server</a></li>
        <li><a href="#views" title="View options">Views</a></li>
      </ul>
    </div>
  </header>

  <section class="command-list server-list">
    <section id="overview">
      <div class="page-header">
        <h1>
          Overview
          <small><span class="options"></span></small>
        </h1>
      </div>
    </section>

    <p>Mimosa's server support comes courtesy of the <code class="option">mimosa-server</code> module.  As such, it belongs to a codebase apart from the core of Mimosa, and it behaves according to the rules of any <a href="./modules.html">Mimosa module</a>, so it can be removed and added at any time.</p>

    <h2>No server necessary</h2>
    <p>With <code class="option">mimosa watch</code> you don't need to use Mimosa to serve up your assets.  You might have a server already.  You might be running Derby, Sinatra, Spring MVC, whatever it might be, you might have serving your assets covered.  <code class="option">mimosa watch</code> is good with that.  It'll run the workflow, compile your code, lint it, write it, and let you handle it from there.</p>

    <p><code class="option">mimosa virgin</code> is even less intrusive.  It will not write your code anywhere, it'll just run the workflow steps pre-write.  You might have an "asset pipeline" that pulls your assets right out of your source code.</p>

    <h2>But if you want one...</h2>
    <p>Toss a <code class="option">-s/--server</code> onto your <code class="option">mimosa watch</code> and Mimosa will invoke a server.  Which server Mimosa invokes depends on what you have in your <code class="option">mimosa-config</code>.  Mimosa could start its own server and point it at your views and assets.  Or Mimosa could start the server it gave you when you ran <code class="option">mimosa new</code>.  Or Mimosa could execute a server you had previously using a simple exports hook.</p>

    <p>All options are nodejs-based.  Mimosa does not have the ability to start your Rails server or your Tomcat.</p>

    <section id="new">
      <div class="page-header">
        <h1>
          Mimosa Delivered Server Assets
          <small><span class="options">what 'mimosa new' gives you</span></small>
        </h1>
      </div>
    </section>

    <h2>Server</h2>

    <p><code class="option">mimosa new</code> will give you the option to have a server of your own or to have Mimosa serve up your application.  If you choose not to have a server of your own, Mimosa will not deliver any sort of server code.</p>

    <p>If you choose the Express option, you will be given a single file, written in the JavaScript meta-language you chose during the <code class="option">mimosa new</code> prompting (<code class="option">server.coffee</code>, for example), that Mimosa will use to start your server. You will also be given a simple router, also in the JavaScript meta-language you chose.</p>

    <h2>Views</h2>

    <p><code class="option">mimosa new</code> will give you the option to select the server view technology you would like to use.  You can use plain HTML if you wish, or any of a number of dynamic templating options. Mimosa does not allow you to choose to have no views. Depending on the technology you choose, you will get one or two view templates for your starter app.</p>

    <section id="mimosas">
      <div class="page-header">
        <h1>
          Mimosa's Embedded Server
          <small><span class="options">mimosa can serve your app</span></small>
        </h1>
      </div>
    </section>

    <p>Mimosa comes bundled with its own Express server.  If you have <code class="option">server.useDefaultServer</code> set to <code class="option">true</code> in your <code class="option">mimosa-config</code>, then when you run <code class="option">mimosa watch</code> with the <code class="option">--server</code> flag, Mimosa will run its embedded server. When running Mimosa's Express, all of the settings in the <code class="option">server</code> portion of the <code class="option">mimosa-config</code> become very important.</p>

    <ul>
      <li><code class="option">server.port</code> is used to determine which port to start the server on.  It defaults to 3000.</li>
      <li><code class="option">server.base</code> will host your application behind a given path.  It defaults to blank, so your application will be available via localhost, but if you were, for instance, to provide 'app' instead, your index page would be available at localhost/app.</li>
      <li><code class="option">server.views.compileWith</code> lets Mimosa know what kind of views you have.</li>
      <li><code class="option">server.views.extension</code> informs Mimosa's Express which files to register your <code class="option">server.views.compileWith</code> against. This gives you the chance to use "html" as an extension for all your views if you wish.</li>
      <li><code class="option">server.views.path</code> points Mimosa to the location of your views.</li>
    </ul>

    <p>Mimosa's Express will do a few things for you in addition to serving up your application.  Assuming <code class="option">liveReload.enabled</code> is set to <code class="option">true</code> (default), you'll have Live Reload functionality for your codebase.  Mimosa will reload your browser whenever a file in <code class="option">liveReload.enabled.additionalDirs</code> (default 'views') or <code class="option">config.watch.compiledDir</code> (default 'public') changes. Mimosa will also serve up your static assets gzipped.</p>

    <section id="yours">
      <div class="page-header">
        <h1>
          Hooked Into Your Server
          <small><span class="options">mimosa can start your app</span></small>
        </h1>
      </div>
    </section>

    <p>If you've got a moderately complex app, you may want the flexibility of having your own server. Delivering you an Express server is the <code class="option">mimosa new</code> default. If <code class="option">server.useDefaultServer</code> is set to <code class="option">false</code>, Mimosa will look for a piece of node.js code located at <code class="option">server.path</code>, and execute the <code class="option">startServer</code> function of that code (so that function must be exported). That function will be passed the entire resolved and enriched <code class="option">mimosa-config</code> for use within your server.</p>

    <p>To take advantage of Mimosa's live reload functionality, the <code class="option">startServer</code> function should return the server object returned by Express's <code class="option">app.listen()</code> function call. If you are using socket.io, then you'll need to change the return so that both your project and Mimosa can use the same socket.io connection.  See the <a href="./utilities.html#reload">Live Reload section</a> on the Utilities page for more details.</p>

    <p>The server code delivered by <code class="option">mimosa new</code> will use all of the configuration from the <code class="option">mimosa-config</code> <code class="option">server</code> block. You could easily choose to remove the usage of the <code class="option">mimosa-config</code> entries from the delivered code. For instance, in the following code, all of the bolded entries could be replaced with their actual values, but this of course means Mimosa will be less capable of controlling behavior of your app.</p>

<pre>app.configure ->
  app.set 'port', <b>config.server.port</b>
  app.set 'views', <b>config.server.views.path</b>
  app.engine <b>config.server.views.extension</b>, engines[<b>config.server.views.compileWith</b>]
  app.set 'view engine', <b>config.server.views.extension</b></pre>

    <section id="yours">
      <div class="page-header">
        <h1>
          Server Views
          <small><span class="options">you've got a few options</span></small>
        </h1>
      </div>
    </section>

    <p>As with the server code delivered to you, the view code and routes are built to be flexible enough to work in several scenarios.  You may wish to remove some conditionals, or to hard-code some properties where it makes sense. You may not need the flexibility.</p>

    <p>Mimosa uses <a href="https://github.com/visionmedia/consolidate.js">consolidate</a>, both internally and within the delivered Express, to easily toggle between different view templating libraries. If you choose to have your own server, consolidate will be installed in your project. Also installed will be the library for the templating library you choose.</p>

    <p>Each of the client libraries has a string that you would use to configure <code class="option">server.views.compileWith</code> to determine which view technology will be used, and each library has a default extension. When you chose one of the client libraries during <code class="option">mimosa new</code>, Mimosa will modify the <code class="option">mimosa-config</code> with these values. The <code class="option">server.views.compileWith</code> values are listed below next to the name of each technology. The default extensions are listed as well.</p>

    <h2>Jade <small><span class="mim">jade</span> <span class="command">.jade</span></small></h2>
    <p><a href="http://jade-lang.com/">Jade</a> is the default server templating language. The project that <code class="option">mimosa new</code> gives you will include simple layout and index pages.</p>

    <h2>EJS <small><span class="mim">ejs</span> <span class="command">.ejs</span></small></h2>
    <p><a href="https://github.com/visionmedia/ejs">EJS</a> is also available, and <code class="option">mimosa new</code> delivers you a single <code class="option">index.ejs</code> file.</p>

    <h2>Hogan <small><span class="mim">hogan</span> <span class="command">.hjs</span></small></h2>
    <p><a href="https://github.com/visionmedia/ejs">Hogan</a> is available, and <code class="option">mimosa new</code> delivers you a single <code class="option">index.hjs</code> file.</p>

    <h2>HTML <small><span class="mim">html</span> <span class="command">.html</span></small></h2>
    <p>You can choose to code plain HTML templates on the server too.  Mimosa actually uses <a href="https://github.com/visionmedia/ejs">EJS</a> behind the scenes (see above), as EJS allows you to code plain HTML pages.  To accommodate the fact that plain HTML isn't dynamic, if you choose to use plain HTML templating, <code class="option">mimosa new</code> will give you two templates, one each for when you are running with and without the <code class="option">optimize</code> flag.  The Express routes know how to toggle between the two.  Also, the delivered server has a switch in its options for Live Reload that will allow plain HTML pages to work just fine, so not having that dynamic toggle in your view will not cause any trouble.</p>

  </section>

</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.7.2.min.js"><\/script>')</script>
<script src="js/vendor/bootstrap-collapse.js"></script>
<script src="js/vendor/bootstrap-scrollspy.js"></script>

<!-- scripts concatenated and minified via build script -->
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<!-- end scripts -->

<script>
    var _gaq=[['_setAccount','UA-33737130-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>
